<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WELCOME HEMATSINH JADEJA</title>
</head>
<body>
  <h2>Upload Images â†’ Convert to Word</h2>
  <h3></h3>

  <form id="uploadForm" enctype="multipart/form-data">
    <input type="file" name="file" accept="image/*" required />
    <button type="submit">Upload</button>
  </form>

  <button id="doneBtn">Done (Generate Word)</button>

  <div id="status"></div>

  <script>
    const uploadForm = document.getElementById("uploadForm");
    const statusDiv = document.getElementById("status");
    const doneBtn = document.getElementById("doneBtn");

    uploadForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(uploadForm);

      const res = await fetch("/upload", {
        method: "POST",
        body: formData,
      });
      const data = await res.json();
  statusDiv.innerHTML += `<p>âœ… Uploaded: ${data.file}</p>`;
    });

    doneBtn.addEventListener("click", async () => {
      const res = await fetch("/finalize");
      const blob = await res.blob();

      // Trigger download
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "output.docx";
      a.click();

  statusDiv.innerHTML += `<p>ðŸ“„ Word file generated</p>`;
    });
  </script>
</body>
</html>